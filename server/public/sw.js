const CACHE="cache-169712106990",ASSETS=["/","/icon/android-chrome-192x192.png","/icon/android-chrome-512x512.png","/icon/apple-touch-icon.png","/icon/browserconfig.xml","/icon/favicon-16x16.png","/icon/favicon-32x32.png","/icon/favicon.ico","/icon/mstile-150x150.png","/icon/safari-pinned-tab.svg","/icon/site.webmanifest","/img/logo.png","/img/logo.jpg","/img/1.jpg","/img/2.jpg","/img/3.jpg","/img/4.jpg","/img/5.jpg","/img/6.jpg","/img/7.jpg","/img/8.jpg","/img/9.jpg","/img/10.jpg","/font/mso.woff2","/font/Montserrat.woff2","/css/check.css","/css/index.css","/css/profile.css","/js/hoisted.js","/js/hoisted2.js","/js/hoisted3.js","/a/countries"];self.addEventListener("install",(e=>e.waitUntil(caches.open(CACHE).then((e=>{console.log(`[SWORKER install] caching "${CACHE}"`),e.addAll(ASSETS)})).then((()=>{sendMessage({text:"install"}),self.skipWaiting()}))))),self.addEventListener("activate",(e=>e.waitUntil(caches.keys().then((async e=>{for(const t of e)t!==CACHE&&(console.log(`[SWORKER removing] cache "${t}"`),await caches.delete(t));sendMessage({text:"activate",action:"reset"}),self.clients.claim()})))));const CONFIG="/config";function sendMessage(e){self.clients.matchAll().then((t=>{t[0]&&self.clients.get(t[0].id).then((t=>{t.postMessage(e)}))}))}self.addEventListener("fetch",(e=>{const{request:t,request:{url:s,method:n}}=e;if(s.match(CONFIG))return"POST"===n?(t.json().then((e=>caches.open(CACHE).then((t=>t.put(CONFIG,new Response(JSON.stringify(e))))))),e.respondWith(new Response("{}"))):e.respondWith(caches.match(CONFIG).then((e=>e||new Response("{}"))));"POST"!==n&&e.respondWith(caches.open(CACHE).then((async t=>{let n=await t.match(e.request);return n||(s.startsWith("chrome-extension")||s.includes("extension")||0!==s.indexOf("http")?await fetch(e.request):(n=await t.match(e.request.url+="index.html"),n||(n=await t.match(e.request.url+="/index.html"),n||(n=await fetch(e.request),n))))})))})),self.onmessage=function(e){"skipWaiting"===e.data.action&&self.skipWaiting(),"update"===e.data.action&&self.registration.update(),"sync"===e.data.action&&self.registration.sync.register("sync-news").then((()=>{})),sendMessage({type:"receive",msg:e.data})},self.addEventListener("notificationclick",(e=>{e.waitUntil(self.clients.matchAll().then((t=>{var s=void 0!==e.notification.data?e.notification.data:{};if(e.notification.close(),t.length>0)return t[0].focus(),t[0].postMessage({msg:s,type:"clientList[0]"});self.clients.openWindow("/profile").then((e=>e)).then((e=>e.postMessage({msg:s,type:"clientList - clients - c"})))})))})),self.addEventListener("push",(e=>{e.waitUntil(self.clients.matchAll().then((t=>{console.log(`[SWORKER push] Push had this data: "${e.data.text()}"`);const s=e.data.json(),n=s.title??"Error",i={body:s.body??"New message from the server!",icon:s.icon??"/icon/android-chrome-192x192.png",badge:s.badge??"/icon/favicon-32x32.png",image:s.image??"/asset/img/og.jpg",vibrate:s.vibrate??[],data:s.data??{}};return t.some((e=>(e.postMessage({msg:s,type:"push"}),e.focused)))?i.body+=" [focused]":t.length>0?i.body+=" [no focused]":i.body+=" [closed]",self.registration.showNotification(n,i)})))}));